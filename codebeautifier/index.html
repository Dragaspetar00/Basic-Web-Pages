<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Code Beautifier — HTML, CSS, JS Otomatik Biçimlendirici</title>
  <meta name="description" content="HTML, CSS ve JavaScript kodlarınızı tek tıkla otomatik biçimlendirin. Hızlı, mobil ve SEO uyumlu, tamamen tarayıcıda çalışan ücretsiz code beautifier." />
  <meta name="keywords" content="code beautifier, kod biçimlendirici, prettier, html formatter, css formatter, js formatter" />
  <meta name="robots" content="index,follow" />
  <link rel="canonical" href="." />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Code Beautifier — HTML, CSS, JS Otomatik Biçimlendirici" />
  <meta property="og:description" content="Kodunuzu tek tıkla güzelleştirin. Prettier ile çalışan hızlı ve havalı bir biçimlendirici." />
  <meta property="og:url" content="." />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="theme-color" content="#0ea5e9" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E✨%3C/text%3E%3C/svg%3E" />
  <link rel="preconnect" href="https://unpkg.com" />
  <style>
    :root{
      --bg:#0b1220;
      --bg-2:#0f172a;
      --card:rgba(255,255,255,.06);
      --card-border:rgba(255,255,255,.14);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --accent:#7c3aed;
      --accent-2:#06b6d4;
      --ok:#22c55e;
      --warn:#f59e0b;
      --err:#ef4444;
      color-scheme: light dark;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1200px 600px at 10% -10%, rgba(124,58,237,.35), transparent 60%),
                  radial-gradient(900px 600px at 110% 10%, rgba(6,182,212,.25), transparent 60%),
                  var(--bg);
      color:var(--text);
      line-height:1.5;
    }
    .skip-link{position:absolute;left:-9999px;top:-9999px}
    .skip-link:focus{left:1rem;top:1rem;background:#fff;color:#000;padding:.5rem .75rem;border-radius:.5rem;z-index:999}
    header{
      position:relative;
      padding: clamp(24px, 4vw, 40px) 20px 12px;
      text-align:center;
    }
    .brand{
      display:inline-flex;align-items:center;gap:12px;justify-content:center;
    }
    .logo{
      width:36px;height:36px;border-radius:12px;
      background: conic-gradient(from 210deg, var(--accent), var(--accent-2), var(--accent));
      box-shadow: 0 8px 30px rgba(124,58,237,.35), inset 0 0 30px rgba(255,255,255,.12);
    }
    h1{
      margin:0;font-size: clamp(22px, 3.5vw, 36px);
      letter-spacing:.3px;
      background: linear-gradient(90deg, #fff, #c7d2fe, #a5f3fc);
      -webkit-background-clip:text;background-clip:text;
      color:transparent;
      font-weight:800;
    }
    .sub{
      color:var(--muted);margin-top:6px;font-size: clamp(13px, 1.9vw, 16px);
    }
    main{
      max-width: 1200px;margin: 10px auto 40px;padding: 0 16px;
    }
    .card{
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 18px;
      backdrop-filter: blur(10px) saturate(140%);
      -webkit-backdrop-filter: blur(10px) saturate(140%);
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      overflow:hidden;
    }
    .controls{
      display:grid;gap:12px;padding:14px;
      grid-template-columns: repeat(2, minmax(0,1fr));
    }
    @media (min-width: 780px){
      .controls{grid-template-columns: 1.2fr 1fr 1fr 1fr 1fr;}
    }
    label.sel, .opt{
      display:flex;align-items:center;gap:10px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
      padding:10px 12px;border-radius:12px;
      font-size:14px;color:var(--muted);
    }
    select, input[type="number"], input[type="text"]{
      background: transparent; color: var(--text); border:none; outline:none; font-size:14px; width:100%;
    }
    .range{display:flex;align-items:center;gap:10px}
    .range input[type="range"]{flex:1}
    input[type="range"]{
      -webkit-appearance:none; appearance:none; height:6px;border-radius:999px; background: rgba(255,255,255,.14);
    }
    input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none;width:18px;height:18px;border-radius:50%;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      border:2px solid white; box-shadow: 0 4px 12px rgba(0,0,0,.2);
    }
    .switch{
      position:relative;display:inline-flex;align-items:center;gap:8px;cursor:pointer;user-select:none
    }
    .switch input{display:none}
    .switch .track{
      width:40px;height:22px;background: rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.18); border-radius:999px;position:relative;flex:none;
    }
    .switch .knob{
      width:18px;height:18px;border-radius:50%;background:#fff;position:absolute;top:50%;left:2px;transform:translate(0,-50%);transition:.18s;
      box-shadow:0 2px 8px rgba(0,0,0,.25)
    }
    .switch input:checked + .track .knob{left:20px;background:linear-gradient(135deg,var(--accent),var(--accent-2))}
    .panes{display:grid;gap:14px;padding:14px;padding-top:0}
    @media (min-width: 980px){ .panes{grid-template-columns: 1fr 1fr;} }
    .pane{
      display:flex;flex-direction:column;gap:8px; min-height: 320px;
    }
    .pane h3{
      margin:2px 4px 0;font-size:13px;color:var(--muted);letter-spacing:.3px;display:flex;align-items:center;gap:8px
    }
    .editor, .output{
      position:relative;flex:1;border-radius:14px;overflow:hidden;
      border:1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
    }
    .editor textarea, .output pre{
      width:100%;height:100%;resize:none;outline:none;border:0;padding:14px 14px 18px;
      font: 13px/1.65 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      color:#e6edf3;background: transparent; tab-size: 2; white-space: pre;
    }
    .editor textarea::placeholder{color:#7c8aa1}
    .soft-shadow{box-shadow: inset 0 1px 0 rgba(255,255,255,.04), 0 10px 25px rgba(0,0,0,.25)}
    .actions{
      display:flex;flex-wrap:wrap;gap:10px;padding:0 14px 14px
    }
    button.btn{
      appearance:none;border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(135deg, rgba(124,58,237,.18), rgba(6,182,212,.18));
      color:#fff;padding:10px 14px;border-radius:12px;cursor:pointer;
      font-weight:600;font-size:14px;display:inline-flex;align-items:center;gap:8px;
      transition: transform .06s ease, box-shadow .2s ease;
      box-shadow: 0 10px 24px rgba(124,58,237,.22);
    }
    button.btn.secondary{background: rgba(255,255,255,.06);box-shadow: none;}
    button.btn:active{transform: translateY(1px)}
    .chips{display:flex;align-items:center;gap:8px;margin-left:auto;flex-wrap:wrap}
    .chip{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:var(--muted);
      padding:6px 10px;border-radius:999px;font-size:12px
    }
    .drop{
      position:absolute;inset:0;border:2px dashed rgba(255,255,255,.20);border-radius:14px;display:none;align-items:center;justify-content:center;
      color:#cbd5e1;background: rgba(6,182,212,.08)
    }
    .editor.dragover .drop{display:flex}
    .tag{
      display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:8px;
      border:1px solid rgba(255,255,255,.12);background: rgba(6,182,212,.10);color:#a5f3fc;font-size:12px
    }
    .spinner{
      position:fixed;inset:auto 16px 16px auto;z-index:50;
      background: rgba(17,24,39,.7);
      border:1px solid rgba(255,255,255,.12);color:#dbeafe;
      padding:10px 12px;border-radius:12px;display:none;backdrop-filter: blur(6px)
    }
    .spinner.show{display:flex;align-items:center;gap:8px}
    .toast{
      position:fixed;left:50%;bottom:18px;transform: translateX(-50%) translateY(30px);
      background:#0b1220cc;color:#e2e8f0;border:1px solid rgba(255,255,255,.14);
      padding:10px 14px;border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,.3);
      opacity:0;transition: .25s;z-index:60;backdrop-filter: blur(6px)
    }
    .toast.show{opacity:1;transform: translateX(-50%) translateY(0)}
    footer{
      text-align:center;color:var(--muted);font-size:13px;margin-top:18px;padding:10px 0 40px
    }
    .kbd{
      font-family: ui-monospace, Menlo, Consolas, monospace; border:1px solid rgba(255,255,255,.2);
      border-bottom-width:2px;border-radius:6px;padding:1px 6px;background: rgba(255,255,255,.06);font-size:12px;color:#cbd5e1
    }
    @media (prefers-reduced-motion: reduce){
      *{animation:none!important;transition:none!important}
    }
  </style>
</head>
<body>
  <a class="skip-link" href="#app">İçeriğe atla</a>
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <h1>Code Beautifier</h1>
    </div>
    <p class="sub">HTML, CSS ve JavaScript kodlarını tek tıkla otomatik biçimlendir. Hızlı. Şık. Ücretsiz.</p>
  </header>

  <main id="app" class="card">
    <div class="controls">
      <label class="sel" title="Biçimlendirilecek dil">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="#93c5fd" aria-hidden="true"><path d="M12 3l4 7H8l4-7zm0 18l-4-7h8l-4 7z"/></svg>
        Dil
        <select id="lang">
          <option value="auto">Otomatik Algıla</option>
          <option value="html">HTML</option>
          <option value="css">CSS</option>
          <option value="babel">JavaScript</option>
        </select>
      </label>

      <div class="range opt" title="Satır genişliği">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="#67e8f9" aria-hidden="true"><path d="M7 6h10v2H7zM3 11h18v2H3zm4 5h10v2H7z"/></svg>
        Satır genişliği
        <input id="printWidth" type="range" min="60" max="140" value="100"/>
        <span id="printWidthVal" class="tag">100</span>
      </div>

      <div class="range opt" title="Sekme genişliği">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="#c4b5fd" aria-hidden="true"><path d="M4 6h8v2H4zm0 5h16v2H4zm0 5h8v2H4z"/></svg>
        Tab genişliği
        <input id="tabWidth" type="range" min="2" max="8" value="2"/>
        <span id="tabWidthVal" class="tag">2</span>
      </div>

      <label class="switch opt" title="Boşluk yerine sekme kullan">
        <input id="useTabs" type="checkbox"/>
        <span class="track"><span class="knob"></span></span>
        <span>Tabs</span>
      </label>

      <label class="switch opt" title="Noktalı virgül kullan">
        <input id="semi" type="checkbox" checked/>
        <span class="track"><span class="knob"></span></span>
        <span>Semicolon</span>
      </label>

      <label class="switch opt" title="Tek tırnak kullan">
        <input id="singleQuote" type="checkbox"/>
        <span class="track"><span class="knob"></span></span>
        <span>Single Quote</span>
      </label>

      <label class="sel" title="Trailing comma">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="#86efac" aria-hidden="true"><path d="M5 6h14v2H5zm0 5h9v2H5zm0 5h14v2H5z"/></svg>
        Trailing comma
        <select id="trailingComma">
          <option value="none">none</option>
          <option value="es5" selected>es5</option>
          <option value="all">all</option>
        </select>
      </label>
    </div>

    <div class="panes">
      <section class="pane">
        <h3>
          <span>Girdi</span>
          <span class="tag">Dosya bırak: .html .css .js</span>
        </h3>
        <div class="editor soft-shadow" id="editor">
          <textarea id="input" spellcheck="false" placeholder="Biçimlendirmek istediğiniz HTML, CSS veya JavaScript kodunu buraya yapıştırın."></textarea>
          <div class="drop" aria-hidden="true">Bırak gitsin 🚀</div>
        </div>
      </section>

      <section class="pane">
        <h3>
          <span>Çıktı</span>
          <span id="outLang" class="tag">hazır</span>
        </h3>
        <div class="output soft-shadow">
          <pre id="output" aria-live="polite"></pre>
        </div>
      </section>
    </div>

    <div class="actions">
      <button id="btnFormat" class="btn" title="Biçimlendir (Ctrl/⌘ + Enter)">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="#fff" aria-hidden="true"><path d="M3 4h18v2H3zm4 7h14v2H7zM3 20h18v-2H3z"/></svg>
        Biçimlendir
      </button>
      <button id="btnSwap" class="btn secondary" title="Çıktıyı girdiyle değiştir">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="#a5b4fc"><path d="M7 7h10v2H7l3 3-1.4 1.4L3.2 8l5.4-5.4L10 4 7 7zm10 10H7v-2h10l-3-3 1.4-1.4 5.4 5.4-5.4 5.4L14 20l3-3z"/></svg>
        Swap
      </button>
      <button id="btnCopy" class="btn secondary" title="Çıktıyı kopyala">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="#93c5fd"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v16h13c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 18H8V7h11v16z"/></svg>
        Kopyala
      </button>
      <button id="btnDownload" class="btn secondary" title="Çıktıyı indir">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="#6ee7b7"><path d="M5 20h14v-2H5m7-14v8l3-3 1.41 1.41L12 18l-4.41-4.59L9 11l3 3V4h2z"/></svg>
        İndir
      </button>
      <button id="btnClear" class="btn secondary" title="Temizle">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="#fca5a5"><path d="M6 19c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
        Temizle
      </button>
      <span class="chips">
        <span id="statLines" class="chip">Satır: 0</span>
        <span id="statChars" class="chip">Karakter: 0</span>
        <span class="chip">Kısayol: <span class="kbd">Ctrl/⌘</span> + <span class="kbd">Enter</span></span>
      </span>
    </div>
  </main>

  <div id="spinner" class="spinner" role="status" aria-live="polite">
    <svg width="16" height="16" viewBox="0 0 50 50" fill="none" aria-hidden="true">
      <circle cx="25" cy="25" r="20" stroke="#67e8f9" stroke-width="5" stroke-linecap="round"
              stroke-dasharray="31.4 31.4">
        <animateTransform attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.9s" repeatCount="indefinite"/>
      </circle>
    </svg>
    Yükleniyor…
  </div>
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <noscript><div style="max-width:820px;margin:10px auto;background:#fee2e2;color:#7f1d1d;padding:10px 14px;border-radius:10px;border:1px solid #fecaca">
    Bu araç JavaScript gerektirir. Lütfen tarayıcıda JavaScript’i etkinleştirin.
  </div></noscript>

  <script>
    // UI elements
    const input = document.getElementById('input');
    const output = document.getElementById('output');
    const outLang = document.getElementById('outLang');
    const printWidth = document.getElementById('printWidth');
    const printWidthVal = document.getElementById('printWidthVal');
    const tabWidth = document.getElementById('tabWidth');
    const tabWidthVal = document.getElementById('tabWidthVal');
    const useTabs = document.getElementById('useTabs');
    const semi = document.getElementById('semi');
    const singleQuote = document.getElementById('singleQuote');
    const trailingComma = document.getElementById('trailingComma');
    const langSelect = document.getElementById('lang');
    const btnFormat = document.getElementById('btnFormat');
    const btnCopy = document.getElementById('btnCopy');
    const btnDownload = document.getElementById('btnDownload');
    const btnSwap = document.getElementById('btnSwap');
    const btnClear = document.getElementById('btnClear');
    const spinner = document.getElementById('spinner');
    const toast = document.getElementById('toast');
    const editor = document.getElementById('editor');
    const statLines = document.getElementById('statLines');
    const statChars = document.getElementById('statChars');

    // Prettier loader (CDN on-demand)
    let prettierReady = false;
    let prettierLoadingPromise = null;
    const PRETTIER_CDN = "https://unpkg.com/prettier@3.3.3";

    function loadScript(src){
      return new Promise((resolve, reject) => {
        const s = document.createElement('script');
        s.src = src; s.async = true; s.crossOrigin = 'anonymous';
        s.onload = () => resolve();
        s.onerror = () => reject(new Error('Yüklenemedi: ' + src));
        document.head.appendChild(s);
      });
    }
    async function ensurePrettier(){
      if (prettierReady) return;
      if (!prettierLoadingPromise){
        const list = [
          PRETTIER_CDN + "/standalone.js",
          PRETTIER_CDN + "/plugins/estree.js",
          PRETTIER_CDN + "/plugins/babel.js",
          PRETTIER_CDN + "/plugins/html.js",
          PRETTIER_CDN + "/plugins/postcss.js",
        ];
        prettierLoadingPromise = list.reduce((p, src) => p.then(() => loadScript(src)), Promise.resolve())
        .then(() => { prettierReady = true; })
        .catch(err => { prettierLoadingPromise = null; throw err; });
      }
      return prettierLoadingPromise;
    }

    // Helpers
    function showSpinner(show){ spinner.classList.toggle('show', !!show); }
    let toastTimer;
    function showToast(msg, isError=false){
      toast.textContent = msg;
      toast.style.borderColor = isError ? 'rgba(239,68,68,.4)' : 'rgba(255,255,255,.14)';
      toast.classList.add('show');
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=> toast.classList.remove('show'), 2200);
    }
    function getPlugins(){
      const pp = window.prettierPlugins;
      if (!pp) return [];
      if (Array.isArray(pp)) return pp;
      return Object.values(pp); // Prettier v3 UMD exports
    }
    function detectLangFromContent(code){
      const t = code.trim();
      if (!t) return 'babel';
      if (/^\s*</.test(t) || /<\w[\s>]/.test(t)) return 'html';
      if (/{[^{}]*:[^{}]*}/.test(t) && !/(function\s*KATEX_INLINE_OPEN|=>|var\s|let\s|const\s|import\s|export\s)/.test(t)) return 'css';
      return 'babel';
    }
    function langLabel(parser){
      return parser === 'html' ? 'HTML' : parser === 'css' ? 'CSS' : 'JavaScript';
    }
  function updateStats(val = output.textContent || ''){
const s = typeof val === 'string' ? val : String(val ?? '');
const lines = s ? s.split(/\r\n|\r|\n/).length : 0;
const chars = s.length;
statLines.textContent = 'Satır: ' + lines;
statChars.textContent = 'Karakter: ' + chars;
}
    function extFor(parser){
      return parser === 'html' ? 'html' : parser === 'css' ? 'css' : 'js';
    }
    function saveSettings(){
      const data = {
        printWidth: +printWidth.value,
        tabWidth: +tabWidth.value,
        useTabs: useTabs.checked,
        semi: semi.checked,
        singleQuote: singleQuote.checked,
        trailingComma: trailingComma.value,
        lang: langSelect.value,
      };
      localStorage.setItem('cb_settings', JSON.stringify(data));
    }
    function loadSettings(){
      try{
        const raw = localStorage.getItem('cb_settings');
        if (!raw) return;
        const s = JSON.parse(raw);
        if ('printWidth' in s) printWidth.value = s.printWidth;
        if ('tabWidth' in s) tabWidth.value = s.tabWidth;
        if ('useTabs' in s) useTabs.checked = s.useTabs;
        if ('semi' in s) semi.checked = s.semi;
        if ('singleQuote' in s) singleQuote.checked = s.singleQuote;
        if ('trailingComma' in s) trailingComma.value = s.trailingComma;
        if ('lang' in s) langSelect.value = s.lang;
      }catch(e){}
      printWidthVal.textContent = printWidth.value;
      tabWidthVal.textContent = tabWidth.value;
    }

  async function formatNow(){
const code = input.value;
if (!code.trim()){ showToast('Biçimlendirmek için kod girin'); return; }
showSpinner(true);
try{ await ensurePrettier(); }
catch(e){ showSpinner(false); showToast('Prettier yüklenemedi: ' + e.message, true); return; }

const parser = (langSelect.value === 'auto') ? detectLangFromContent(code) : langSelect.value;
const options = {
parser,
plugins: getPlugins(),
printWidth: +printWidth.value,
tabWidth: +tabWidth.value,
useTabs: useTabs.checked,
semi: semi.checked,
singleQuote: singleQuote.checked,
trailingComma: trailingComma.value,
bracketSpacing: true,
htmlWhitespaceSensitivity: 'css'
};

try{
const formatted = await window.prettier.format(code, options); // önemli değişiklik
output.textContent = formatted;
outLang.textContent = langLabel(parser);
outLang.style.background = parser === 'html' ? 'rgba(96,165,250,.18)' : parser === 'css' ? 'rgba(167,139,250,.18)' : 'rgba(52,211,153,.18)';
updateStats(formatted);
showToast('Kod biçimlendirildi ✨');
}catch(err){
output.textContent = '// Hata: ' + err.message;
outLang.textContent = 'Hata';
updateStats(output.textContent);
showToast('Biçimlendirme hatası: ' + err.message, true);
}finally{
showSpinner(false);
}
}
    // Drag & Drop
    ;['dragenter','dragover'].forEach(evt => {
      editor.addEventListener(evt, e => { e.preventDefault(); e.stopPropagation(); editor.classList.add('dragover'); });
    });
    ;['dragleave','drop'].forEach(evt => {
      editor.addEventListener(evt, e => { e.preventDefault(); e.stopPropagation(); editor.classList.remove('dragover'); });
    });
    editor.addEventListener('drop', async (e) => {
      const f = e.dataTransfer.files && e.dataTransfer.files[0];
      if (!f) return;
      const text = await f.text();
      input.value = text;
      updateStats('');
      const ext = (f.name.split('.').pop() || '').toLowerCase();
      if (['html','htm'].includes(ext)) langSelect.value = 'html';
      else if (ext === 'css') langSelect.value = 'css';
      else if (['js','mjs','cjs'].includes(ext)) langSelect.value = 'babel';
      else langSelect.value = 'auto';
      showToast('Dosya yüklendi: ' + f.name);
    });

    // Buttons
    btnFormat.addEventListener('click', formatNow);
    btnCopy.addEventListener('click', async ()=>{
      const text = output.textContent || '';
      try{
        await navigator.clipboard.writeText(text);
        showToast('Kopyalandı 📋');
      }catch(e){
        // Fallback
        const ta = document.createElement('textarea');
        ta.value = text; document.body.appendChild(ta); ta.select();
        try{ document.execCommand('copy'); showToast('Kopyalandı 📋'); } catch(e2){ showToast('Kopyalanamadı', true); }
        document.body.removeChild(ta);
      }
    });
    btnDownload.addEventListener('click', ()=>{
      const currentParser = (langSelect.value === 'auto') ? detectLangFromContent(output.textContent || input.value || '') : langSelect.value;
      const ext = extFor(currentParser);
      const blob = new Blob([output.textContent || ''], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'beautified.' + ext;
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
      showToast('Dosya indirildi ⬇️');
    });
    btnSwap.addEventListener('click', ()=>{
      const txt = output.textContent || '';
      if (!txt.trim()){ showToast('Çıktı boş', true); return; }
      input.value = txt;
      showToast('Çıktı girdiye aktarıldı');
    });
    btnClear.addEventListener('click', ()=>{
      input.value = ''; output.textContent = ''; outLang.textContent = 'hazır'; updateStats('');
    });

    // Shortcuts
    document.addEventListener('keydown', (e)=>{
      const isMac = navigator.platform.toUpperCase().includes('MAC');
      if ((isMac && e.metaKey && e.key === 'Enter') || (!isMac && e.ctrlKey && e.key === 'Enter')){
        e.preventDefault(); formatNow();
      }
    });

    // Live UI values + settings
    printWidth.addEventListener('input', ()=>{ printWidthVal.textContent = printWidth.value; saveSettings(); });
    tabWidth.addEventListener('input', ()=>{ tabWidthVal.textContent = tabWidth.value; saveSettings(); });
    [useTabs, semi, singleQuote, trailingComma, langSelect].forEach(el => el.addEventListener('change', saveSettings));

    // Initial content sample (for vibe)
   const sample = `<!-- Örnek HTML -->

<div class="card"><h2>Merhaba Dünya</h2><p>Bu bir <strong>örnek</strong> içerik.</p></div><!-- Örnek CSS --><style> .card{padding:10px;background:#111;border-radius:8px;color:#fff} .card h2{margin:0 0 8px} </style><!-- Örnek JS --><script> const list=[1,2,3].map(n=>({n,square:n*n}));console.log("Squares:",list) <\/script>`;
    loadSettings();
    input.value = sample;
    updateStats('');

    // Small UX niceties
    window.addEventListener('load', ()=>{
      // Hint: Lazy warm-up prettier in idle time
      if ('requestIdleCallback' in window){
        requestIdleCallback(()=> ensurePrettier().catch(()=>{}), {timeout: 3000});
      }
    });
  </script>

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"SoftwareApplication",
    "name":"Code Beautifier",
    "applicationCategory":"DeveloperApplication",
    "operatingSystem":"Any",
    "description":"HTML, CSS ve JavaScript kodlarını otomatik biçimlendiren hızlı ve ücretsiz araç.",
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"}
  }
  </script>

  <footer>
    Made with ❤️ — Prettier destekli. Gizlilik: Kodunuz tarayıcıdan dışarı çıkmaz.
  </footer>
</body>
</html>